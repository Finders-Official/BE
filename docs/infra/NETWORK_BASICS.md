# 네트워크 기초 개념 학습

> 개발자가 알아야 할 네트워크 기초를 쉽게 설명

## 목차
1. [IP 주소와 포트](#1-ip-주소와-포트)
2. [공인 IP vs 사설 IP](#2-공인-ip-vs-사설-ip)
3. [방화벽](#3-방화벽)
4. [VPC (Virtual Private Cloud)](#4-vpc-virtual-private-cloud)
5. [Subnet과 CIDR](#5-subnet과-cidr)
6. [NAT (Network Address Translation)](#6-nat-network-address-translation)
7. [포트 포워딩](#7-포트-포워딩)
8. [프록시와 리버스 프록시](#8-프록시와-리버스-프록시)
9. [로드 밸런서](#9-로드-밸런서)
10. [실전 예제](#10-실전-예제)

---

## 1. IP 주소와 포트

### IP 주소 = 집 주소
```
192.168.1.100 = 서울시 강남구 테헤란로 123
```

### 포트 = 동호수
```
192.168.1.100:80   = 101동 80호 (웹서버)
192.168.1.100:443  = 101동 443호 (보안 웹서버)
192.168.1.100:3306 = 101동 3306호 (데이터베이스)
```

### 주요 포트 번호

| 포트 | 서비스 | 비유 |
|------|--------|------|
| 22 | SSH | 관리실 (원격 접속) |
| 80 | HTTP | 1층 로비 (일반 웹) |
| 443 | HTTPS | 지하 금고 (암호화 웹) |
| 3306 | MySQL | 서버실 (데이터베이스) |
| 8080 | 개발 서버 | 작업실 (테스트용) |

### 예시
```bash
# 구글 웹사이트 접속
https://142.250.196.78:443

# 일반적으로는 도메인 사용
https://google.com  (자동으로 :443 포트)
```

---

## 2. 공인 IP vs 사설 IP

### 비유: 전화번호

**공인 IP = 회사 대표 전화번호**
```
02-1234-5678 ← 외부에서 누구나 전화 가능
```

**사설 IP = 내선 번호**
```
내선 1234 ← 회사 내부에서만 통화 가능
```

### IP 범위

**공인 IP (Public IP)**
- 전 세계에서 유일한 주소
- 예: `34.50.19.146` (Finders 서버)
- 인터넷에서 직접 접근 가능

**사설 IP (Private IP)**
| 대역 | 범위 | 용도 |
|------|------|------|
| Class A | 10.0.0.0 ~ 10.255.255.255 | 대규모 (회사, 클라우드) |
| Class B | 172.16.0.0 ~ 172.31.255.255 | 중규모 |
| Class C | 192.168.0.0 ~ 192.168.255.255 | 소규모 (가정, 사무실) |

### 실제 예시
```
집 공유기:
  공인 IP: 211.200.10.50 (KT에서 할당)

  사설 IP:
  ├─ 내 노트북: 192.168.0.10
  ├─ 스마트폰: 192.168.0.11
  └─ 태블릿:   192.168.0.12

외부에서는 211.200.10.50만 보임
내부 기기들은 192.168.0.x로 통신
```

---

## 3. 방화벽

### 비유: 아파트 경비실

```
[외부 사람들]
    ↓
[경비실 - 방화벽]
- 입주민만 통과 ✅
- 택배 기사 통과 ✅
- 수상한 사람 차단 ❌
    ↓
[아파트 내부]
```

### 방화벽 규칙 예시

```bash
# GCP 방화벽 규칙
포트 22 (SSH):
  - 허용 IP: 123.45.67.89/32 (내 IP만)
  - 동작: 허용

포트 80 (HTTP):
  - 허용 IP: 0.0.0.0/0 (모든 IP)
  - 동작: 허용

포트 3306 (MySQL):
  - 허용 IP: 없음
  - 동작: 차단
```

### 실전 활용
```
일반인: 1층 로비(웹)만 접근 가능
직원: 관리실(SSH)도 접근 가능
외부인: 서버실(DB) 접근 불가
```

---

## 4. VPC (Virtual Private Cloud)

### 비유: 아파트 단지

```
[인터넷 - 공개된 거리]
    ↓
[VPC - 담장으로 둘러싸인 아파트 단지]
    ├─ [101동] Public Subnet
    │   └─ 로비, 엘리베이터 (외부인 접근 가능)
    │
    └─ [102동] Private Subnet
        └─ 주거 공간 (주민만 접근 가능)
```

### VPC의 역할
1. **격리**: 다른 사람의 VPC와 완전히 분리
2. **제어**: 누가 들어올 수 있는지 결정
3. **보안**: 외부에서 내부 IP 직접 접근 불가

### 예시 구조
```
Finders VPC (10.0.0.0/16)
├─ Public Subnet (10.0.1.0/24)
│   ├─ 웹 서버 (10.0.1.10)
│   └─ Bastion Host (10.0.1.20)
│
└─ Private Subnet (10.0.2.0/24)
    ├─ 앱 서버 (10.0.2.10)
    └─ DB 서버 (10.0.2.20)
```

---

## 5. Subnet과 CIDR

### Subnet = 아파트 동

```
아파트 단지 (VPC)
├─ 101동 (Subnet A) - 1~100호
├─ 102동 (Subnet B) - 101~200호
└─ 103동 (Subnet C) - 201~300호
```

### CIDR 표기법

**`/24` = 뒤 8비트만 변경 가능**
```
10.0.1.0/24
= 10.0.1.0 ~ 10.0.1.255
= 256개 IP 주소
```

**`/16` = 뒤 16비트 변경 가능**
```
10.0.0.0/16
= 10.0.0.0 ~ 10.0.255.255
= 65,536개 IP 주소
```

**`/32` = 1개 IP만**
```
10.0.1.100/32
= 10.0.1.100 (딱 1개)
```

### 실전 활용
```bash
# 내 IP만 SSH 허용
--source-ranges=123.45.67.89/32

# 회사 IP 대역 허용
--source-ranges=123.45.0.0/16

# 전체 허용 (비권장)
--source-ranges=0.0.0.0/0
```

---

## 6. NAT (Network Address Translation)

### 비유: 회사 대표 전화

```
[외부]
    ↓
[회사 대표번호: 02-1234-5678] ← NAT
    ↓ 내선으로 전환
[직원들]
├─ 홍길동 (내선 1001)
├─ 김철수 (내선 1002)
└─ 이영희 (내선 1003)

외부에서는 02-1234-5678만 보임
실제 통화는 내선으로 연결
```

### NAT의 역할

**Private → Public 변환**
```
[Private 서버: 10.0.2.10]
    → "나 패키지 다운받고 싶어"
    ↓
[NAT: 34.50.19.146]
    → 공인 IP로 변환
    ↓
[인터넷: apt 서버]
```

### 장점
- Private IP 보호 (외부에 노출 안 됨)
- 공인 IP 절약 (여러 기기가 1개 공인 IP 공유)

### Cloud NAT Gateway
```
[Private Subnet의 서버들]
    ↓ 외부 요청
[Cloud NAT Gateway] (Public Subnet)
    ↓ 공인 IP로 변환
[인터넷]

🔒 외부 → Private 접속 불가
✅ Private → 외부 요청 가능
```

---

## 7. 포트 포워딩

### 비유: 호텔 프론트 데스크

```
[손님] "203호실 연결해주세요"
    ↓
[프론트 데스크] ← 포트 포워딩
    ↓ 전화 연결
[203호실 손님]
```

### 실제 동작

```
공유기 설정:
  외부 포트 8080 → 내부 192.168.0.10:8080 (웹서버)
  외부 포트 3389 → 내부 192.168.0.20:3389 (원격)

외부에서 접속:
  211.200.10.50:8080 접속
    ↓ 포트 포워딩
  192.168.0.10:8080로 연결
```

### 클라우드에서는?
```
[Load Balancer] :80
    ↓ 포트 포워딩
[App Server 1] :8080
[App Server 2] :8080
[App Server 3] :8080
```

---

## 8. 프록시와 리버스 프록시

### 프록시 (Forward Proxy)

**비유**: 대리인을 통한 쇼핑

```
[당신]
    ↓ "이거 대신 사줘"
[대리인 - 프록시]
    ↓
[쇼핑몰]

쇼핑몰은 대리인이 산다고 생각
당신의 정보는 숨겨짐
```

**실제 사용**:
- 회사 프록시 (차단 사이트 우회)
- VPN (IP 숨김)

### 리버스 프록시 (Reverse Proxy)

**비유**: 호텔 컨시어지

```
[손님] "체크인하러 왔어요"
    ↓
[컨시어지 - nginx]
    ├─ "203호 안내해드릴게요"
    ├─ "레스토랑은 2층입니다"
    └─ "짐은 벨보이가 옮겨드립니다"

손님은 뒤에서 누가 일하는지 모름
```

**nginx 예시**:
```nginx
[Client]
    ↓
[nginx :80]
    ├─ /api/* → Spring Boot :8080
    ├─ /admin/* → Admin Panel :3000
    └─ /static/* → 정적 파일 서빙

Client는 nginx만 보임
실제 서버들은 숨겨짐
```

---

## 9. 로드 밸런서

### 비유: 마트 계산대 안내

```
[고객들]
    ↓
[안내 직원 - 로드밸런서]
    ├─ 1번 계산대 (비어있음) ← 이쪽으로 안내
    ├─ 2번 계산대 (사람 많음)
    └─ 3번 계산대 (고장남) ← 안내 안함
```

### 실제 동작

```
[사용자 요청 1000개/초]
    ↓
[Application Load Balancer]
    ├─ Server 1 (CPU 30%) ← 400개
    ├─ Server 2 (CPU 50%) ← 300개
    └─ Server 3 (CPU 20%) ← 300개

자동으로 부하 분산
서버 다운 시 자동 제외
```

### 헬스체크
```
ALB가 30초마다 확인:
  GET /health → Server 1: 200 OK ✅
  GET /health → Server 2: 200 OK ✅
  GET /health → Server 3: 500 Error ❌ 제외

Server 3가 복구되면 다시 포함
```

---

## 10. 실전 예제

### 예제 1: 집에서 회사 서버 접속

```
[집 PC]
IP: 211.200.10.50 (공인 IP)
    ↓ SSH (포트 22)
[회사 방화벽]
- 211.200.10.50 허용 ✅
    ↓
[회사 서버]
IP: 10.0.1.100 (사설 IP)
```

### 예제 2: 사용자가 Finders 접속

```
[사용자 브라우저]
    ↓ https://api.finders.it.kr
[Cloudflare Edge]
- DDoS 방어
- 봇 차단
    ↓ 암호화된 터널
[cloudflared 데몬] (Compute Engine 내부)
    ↓
[Spring Boot :8080]
    ↓
[Cloud SQL]
```

### 예제 3: Private 서버가 패키지 다운로드

```
[Private 서버: 10.0.2.10]
    → "apt update 하고 싶어"
    ↓
[Cloud NAT: 34.50.19.146]
    → 공인 IP로 변환
    ↓
[Ubuntu 패키지 서버]
    → 다운로드 시작
    ↓
[Cloud NAT]
    → 10.0.2.10으로 전달
    ↓
[Private 서버]
    → 설치 완료
```

---

## 📚 학습 순서 추천

### 1주차: 기초 개념
- [ ] IP 주소와 포트 이해
- [ ] 공인 IP vs 사설 IP 구분
- [ ] 방화벽의 역할

### 2주차: 클라우드 네트워크
- [ ] VPC 개념
- [ ] Subnet 이해
- [ ] CIDR 표기법

### 3주차: 보안
- [ ] NAT 동작 원리
- [ ] 포트 포워딩
- [ ] SSH 터널링

### 4주차: 실전
- [ ] nginx 설정
- [ ] 로드 밸런서
- [ ] Cloudflare 활용

---

## 🎯 퀴즈

### Quiz 1
```
Q: 192.168.0.100:3306은 무슨 의미인가?
A: IP 주소 192.168.0.100의 3306번 포트 (MySQL)
```

### Quiz 2
```
Q: 10.0.1.0/24는 몇 개의 IP를 포함하는가?
A: 256개 (10.0.1.0 ~ 10.0.1.255)
```

### Quiz 3
```
Q: Private Subnet의 서버가 인터넷에 요청하려면?
A: NAT Gateway 필요
```

### Quiz 4
```
Q: 외부에서 Private Subnet의 DB에 직접 접속할 수 있는가?
A: 불가능. Bastion Host나 Cloudflare Tunnel 필요
```

### Quiz 5
```
Q: nginx의 역할은?
A: 리버스 프록시, 로드 밸런싱, 블루-그린 배포
```

---

## 🔗 참고 자료

### 온라인 강의
- [생활코딩 - 네트워크](https://opentutorials.org/course/1)
- [널널한 개발자 - 네트워크 기초](https://www.youtube.com/c/널널한개발자)

### 실습 환경
- [GCP Free Tier](https://cloud.google.com/free) - 무료로 VPC 실습
- [Cloudflare](https://www.cloudflare.com/) - 무료 Tunnel

### 도구
- `ping` - 연결 테스트
- `traceroute` - 경로 추적
- `dig` / `nslookup` - DNS 조회
- `netstat` / `ss` - 네트워크 상태
- `tcpdump` - 패킷 캡처

---

## 💡 핵심 정리

1. **IP + Port = 주소 + 동호수**
2. **공인 IP는 외부에서, 사설 IP는 내부에서**
3. **방화벽은 경비실, VPC는 아파트 단지**
4. **NAT는 대표 번호, 포트 포워딩은 내선 연결**
5. **Proxy는 대리인, Reverse Proxy는 컨시어지**
6. **로드 밸런서는 교통 정리**

---

**다음 단계**: [NETWORK_SECURITY.md](./NETWORK_SECURITY.md)에서 실전 설정 배우기
